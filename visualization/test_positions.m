% -------------------------------------------------------------------------
% Author: ZAB
% DATE:   17 February 2020
% -------------------------------------------------------------------------
line='-------------------------------------------------------------------';

% location of the codes on LosertLab NAS
if(ispc)
    addpath(genpath('X:\Zack\lib\MATLAB\ImageAnalysis'));
else
    addpath(genpath('/Volumes/GranularExperimentsData/Zack/lib/MATLAB/ImageAnalysis'));
end
date                = '210409';
[saveDir,loadDir]   = getDirectories(date);
radius    = 14;
zmax      = 270;
n         = 17;
doIMSfilt = true;

% -------------------------------------------------------------------------
%%                          Get the positions
% -------------------------------------------------------------------------
if(doIMSfilt)
    load(sprintf('%sIMS_filt_%04d.mat',saveDir,n),'IMS_filt');
    getPositions(n,saveDir,loadDir,zmax,radius,18,10,IMS_filt);
else
    getPositions(n,saveDir,loadDir,zmax,radius,12,10);
end
%%
load(sprintf('%sxyz_%04d.mat',saveDir,n),'xyzp');
load(sprintf('%sIMS_filt_%04d.mat',saveDir,n),'IMS_filt');
% -------------------------------------------------------------------------
%%
% -------------------------------------------------------------------------
[~,IMS_sph] = drawcyl(IMS_filt,xyzp,radius-2);
% -------------------------------------------------------------------------
%%
% -------------------------------------------------------------------------
close all
figure(1);
movegui(gcf,[200,200]);
for i = 1:size(IMS_filt,3)
    viewOutline(IMS_filt,i,IMS_sph)
end
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------
% -------------------------------------------------------------------------